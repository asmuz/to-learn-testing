# Глава 4. Тестирование граничных значений

### Введение

Тестирование классов эквивалентности - это самая основная методика тест-дизайна. Она помогает тестировщикам выбрать небольшое подмножество из всех возможных тестовых сценариев и при этом обеспечить приемлемое покрытие. У этой техники есть еще один плюс. Она приводит к идее о тестировании граничных значений - второй ключевой технике тест-дизайна.

В предыдущей главе описывались правила, которые указывали, каким образом будет происходить обработка заявок на вакансии в зависимости от возраста соискателя. Эти правила:
  - от 0 до 16​ - не принимаются
  - от 16 до 18​ - могут быть приняты только на неполный рабочий день
  - от 18 до 55​ - могут быть приняты как сотрудники на полный рабочий день
  - от 55 до 99​ - не принимаются

Обратите внимание на проблемы на границах - это "края" каждого класса. Возраст "16" входит в два различных класса эквивалентности (как и "18", и "55"). Первое правило гласит не нанимать шестнадцатилетних. Второе правило гласит, что шестнадцатилетние могут быть наняты на неполный рабочий день.

Тестирование граничных значений фокусируется на границах именно потому, что там спрятано очень много дефектов. Опытные тестировщики сталкивались с этой ситуацией много раз. У неопытных тестировщиков может появиться интуитивное ощущение, что ошибки будут возникать чаще всего на границах. Эти дефекты могут быть в требованиях (как показано выше), или в коде, как показано ниже.
```C
If (applicantAge >= 0 && applicantAge <= 16)
hireStatus = "NO";
If (applicantAge >= 16 && applicantAge <= 18)
hireStatus = "PART";
If (applicantAge >= 18 && applicantAge <= 55)
hireStatus = "FULL";
If (applicantAge >= 55 && applicantAge <= 99)
hireStatus = "NO";
```

Конечно, ошибка, которую допустили программисты - это неправильная проверка неравенства. Правильной является запись ">" (больше, чем) вместо "≥" (больше либо равно). Тестирование граничных значений фокусируется на границах, потому что там спрятано очень много дефектов. Наиболее эффективный способ поиска таких дефектов - просмотр либо требований, либо кода. Прекрасным руководством такого процесса является книга Гилба и Грэма "Инспектирование программ" Тем не менее, независимо от того, насколько эффективны наши осмотры, мы захотим протестировать код,
чтобы проверить его правильность. Возможно, что тестируемая нами организация имеет в виду следующее:
  - от 0 до 15​ - не принимаются
  - от 16 до 17​ - могут быть приняты только на неполный рабочий день
  - от 18 до 54​ - могут быть приняты как сотрудники на полный рабочий день
  - от 55 до 99​ - не принимаются

А что насчет возраста -3 и 101? Обратите внимание, что требования не указывают, как должны быть рассмотрены эти значения. Мы можем догадаться, но "угадывание требований" не является приемлемой практикой.

Следующий код реализует исправленные правила:
```C
if (applicantAge >= 0 && applicantAge <= 15)
hireStatus = "NO";
if (applicantAge >= 16 && applicantAge <= 17)
hireStatus = "PART";
if (applicantAge >= 18 && applicantAge <= 54)
hireStatus = "FULL";
if (applicantAge >= 55 && applicantAge <= 99)
hireStatus = "NO";
```

В этом примере интересными значениями на границах или вблизи них являются {-1, 0, 1}, {15, 16, 17}, {17,18, 19}, {54, 55, 56} и {98, 99, 100}. Другие значения, например {-42, 1001, FRED, %$#@} могут быть включены в зависимости от предусловий документации модуля.

### Методика

Для использования тестирования граничных значений есть простые шаги. Во-первых, нужно определить классы эквивалентности. Во-вторых, нужно определить границы каждого класса эквивалентности.

В-третьих, создать тест-кейсы для каждого граничного значения, выбрав одну точку на границе, одну точку чуть ниже границы и одну точку чуть выше границы. "Ниже" и "выше" являются относительными величинами и зависят от единиц измерения данных. Если границей является число "16" и тип "integer", то точкой "ниже" является значение "15", а точкой "выше" - "17". Если границей является $5.00 и тип "доллары и центы США", то точкой "ниже" будет $4.99, а точкой "выше" - $5.01. С другой стороны, если значение $5 и тип "доллары США", то нижней точкой будет $4, а верхней - $6. Для создания тест-кейсов для каждого граничного значения выберите одну точку на границе, одну точку чуть ниже границы и одну точку чуть выше границы.

Стоит отметить, что точка чуть выше границы может входить в другой класс эквивалентности. В таком случае не нужно дублировать тест. То же самое может быть верно по отношению точки чуть ниже границы.

Конечно, если у вас есть ресурсы, то вы можете создать дополнительные тест-кейсы дальше от границ (в пределах классов эквивалентности). Как уже говорилось в предыдущей главе, эти дополнительные тест-кейсы могут заставить вас почувствовать себя тепло и комфортно, но они редко обнаруживают дополнительные дефекты.

Тестирование граничных значений является наиболее подходящим там, где входные данные являются непрерывным диапазоном значений. Возвращаясь к ипотечной компании Гуфи, каковы интересные граничные значения? Для ежемесячного дохода границы составляют $1 000 и $83 333 в месяц (при условии, что единицей являются доллары США).

![Рисунок 5: Непрерывные классы эквивалентности](https://raw.githubusercontent.com/kostyashelest/software-test-design/master/img/img_5.png)

*Граничные значения для непрерывного диапазона входных данных.*

Для тестирования границ в качестве тестовых данных выбраны {$999, $1000, $1001} на нижней границе и {$83332, $83333, $83334} на верхней границе. Поскольку компания Гуфи выдает ипотеку на покупку от одного до пяти домов, то ноль и меньше домов или шесть и больше будут являться недопустимыми входными значениями. Это тоже границы для тестирования.

![Рисунок 6: Непрерывные классы эквивалентности](https://raw.githubusercontent.com/kostyashelest/software-test-design/master/img/img_6.png)

*Граничные значения для разрывного диапазона входных данных.*

У нас редко будет время для того, чтобы создать отдельные тесты для каждого граничного значения каждого входного значения, которое вводится в систему. Чаще всего мы будет создавать несколько тестов, которые будут проверять некоторое количество полей ввода одновременно.

| Ежемесячный доход | Количество домов  | Результат | Описание |
| --- | --- | --- | --- |
| $1000 | 1 | корректно | Минимальный доход, минимальное количество домов |
| $83333 | 1 | корректно | Максимальный доход, минимальное количество домов |
| $1000 | 5 | корректно | Минимальный доход, максимальное количество домов |
| $83333 | 5 | корректно | Максимальный доход, максимальное количество домов |
| $1000 | 0 | некорректно | Минимальный доход, ниже минимального количества домов |
| $1000 | 6 | некорректно | Минимальный доход, выше максимального количества домов |
| $83333 | 0 | некорректно | Максимальный доход, ниже максимального количества домов |
| $83333 | 6 | некорректно | Максимальный доход, выше максимального количества домов |
| $999 | 1 | некорректно | Ниже минимального дохода, минимальное количество домов |
| $83334 | 1 | некорректно | Выше максимального дохода, минимальное количество домов |
| $999 | 5 | некорректно | Ниже минимального дохода, максимальное количество домов |
| $83334 | 5 | некорректно | Выше максимального дохода, максимальное количество домов |

*Набор тест-кейсов, содержащих комбинации допустимых (на границе) и недопустимых (за
границей) значений*

График, на котором на оси ​ х ​ отложены значения "ежемесячного дохода", а на оси y - "количество жилых помещений", показывает положение точек тестовых данных.

![Рисунок 7: Непрерывные классы эквивалентности](https://raw.githubusercontent.com/kostyashelest/software-test-design/master/img/img_7.png)

*Точки данных на границах и точки данных в непосредственной близости от границ.*

Обратите внимание, что четыре входных комбинации расположены на границах, а восемь находятся в непосредственной близости. Также обратите внимание, что точки вне границ всегда сочетают одно допустимое значение с одним недопустимым значением (только одной единицей измерения ниже или только одной единицей измерения выше).

### Примеры

Тестирование граничных значений применимо к структуре (длине и типу символов) входных данных, а также к её значениям. Рассмотрим следующие два примера:

**Пример 1**

Ссылаясь на веб-страницу заказа веб-сайта Браун и Дональдсон, описанного в Приложении А, рассмотрим поле "Количество". Ввести в это поле можно от одного до четырех цифровых знаков (0, 1, ..., 8, 9). Тестовым набором граничных значений для длины этого поля будут {0, 1, 4, 5} цифровых символов.

**Пример 2**

Опять же, на странице заказа, рассмотрим поле "Количество", но на этот раз значения, а не структуру (длину и тип символов). Если сделкой является покупка или продажа, то минимальное возможное значение равно 1, так что для граничного тестирования используйте {0, 1, 2}. Верхняя граница значения этого поля является более сложной. Если сделкой является продажа, то какое максимальное количество акций, которое может быть продано? Это количество акций, имеющихся на данный момент в собственности. Для границ используйте {принадлежащиеАкции-1, принадлежащиеАкции, принадлежащиеАкции + 1}. Если сделкой является покупка, то максимальное значение (количество акций, которые будут приобретены) определяется как: акции = (балансАккаунта - комиссия) / ценаАкции, предполагая фиксированную комиссию. Для тестирования граничных значений используйте {акции-1,
акции, акции + 1}.

### Применения и ограничения

Тестирование граничных значений может значительно уменьшить количество тестов, которые должны быть созданы и выполнены. Такое тестирование больше всего подходит для систем, в которых большая часть входных данных принимает значения в пределах диапазонов или из наборов данных. Тестирование граничных значений в равной степени применимо на модульном, интеграционном, системном и приемочном уровнях тестирования. Для тестирования граничных значений требуются входные значения, которые могут быть разделены на классы и границы, которые могут быть определены на основе системных требований.

### Резюме

  - Несмотря на то, что тестирование классов эквивалентности полезно, его величайшим вкладом является то, что оно приводит нас к тестированию граничных значений.
  - Тестирование граничных значений - это техника, используемая для уменьшения числа тестовых наборов до выполнимого уровня при сохранении приемлемого уровня покрытия тестами.
  - Тестирование граничных значений фокусируется на границах, потому что там спрятано очень много дефектов. Опытные тестировщики сталкивались с этой ситуацией много раз. У неопытных тестировщиков может появиться интуитивное ощущение, что ошибки будут возникать чаще всего на границах.
  - При создании тестов для каждого граничного значения выбирается одна точка на границе, одна точка чуть ниже границы и одна точка чуть выше границы. "Ниже" и "выше" являются относительными величинами и зависят от единиц измерения данных.

### Практика
1. Следующие упражнения относятся к веб-сайту "Регистрационная система Государственного университета", описанному в приложении Б. Определите границы и подходящие тестовые граничные значения для следующего:
  - ZIP-код (почтовый индекс) - пять цифр.
  - Сначала рассмотрите почтовый индекс только с точки зрения цифр. Затем определите минимальный и максимальный корректные почтовые индексы в США. Дополнительно​ 1​ , определите формат минимального и максимального допустимых значений почтовых кодов для Канады.
  - Фамилия - пятнадцать символов (включая алфавитные символы, точек, дефисы, апострофы, пробелы и числа). Дополнительно​ 2​ создайте несколько очень сложных фамилий. Можете ли вы определить "правила" для корректных фамилий? Дополнительно​ 3​ используйте телефонную книгу из другой страны - попробуйте Финляндию или Тайланд.
  - Идентификатор пользователя - восемь символов, как минимум два из которых являются не буквой (число, спецсимвол, непечатаемый символ).
  - Идентификатор курса - три буквенных символа, представляющие факультет последующим шестизначным числом, которое является уникальным идентификационным номером курса. Возможные факультеты:
    - PHY - физика
    - EGR - инжиниринг
    - ENG - английский
    - LAN - иностранные языки
    - CHM - химия
    - MAT - математика
    - PED - физкультура
    - SOC - социология
  - [1] На самом деле нет никаких дополнительных выгод, поэтому сделайте это просто для удовольствия.
  - [2] На самом деле нет никаких дополнительных выгод, поэтому сделайте это просто для удовольствия.
  - [3] На самом деле нет никаких дополнительных выгод, поэтому сделайте это просто для удовольствия.

**Литература**
Beizer, Boris​ (1990). ​ Software Testing Techniques. Van Nostrand Reinhold. Glib, Tom and Dorothy Graham​ (1993). Software Inspection. Addison-Wesley. ISBN 0-201-63181-4. Myers. Glenford J.​ (1979). ​ The Art of Software Testing. John Wiley & Sons.
